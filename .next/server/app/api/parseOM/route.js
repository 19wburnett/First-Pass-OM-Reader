"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/parseOM/route";
exports.ids = ["app/api/parseOM/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pdf-parse":
/*!****************************!*\
  !*** external "pdf-parse" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("pdf-parse");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2FparseOM%2Froute&page=%2Fapi%2FparseOM%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2FparseOM%2Froute.ts&appDir=C%3A%5CUsers%5Cwesto%5COneDrive%5CDocuments%5CFirst%20Pass%20OM%20Reader%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cwesto%5COneDrive%5CDocuments%5CFirst%20Pass%20OM%20Reader&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2FparseOM%2Froute&page=%2Fapi%2FparseOM%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2FparseOM%2Froute.ts&appDir=C%3A%5CUsers%5Cwesto%5COneDrive%5CDocuments%5CFirst%20Pass%20OM%20Reader%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cwesto%5COneDrive%5CDocuments%5CFirst%20Pass%20OM%20Reader&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_westo_OneDrive_Documents_First_Pass_OM_Reader_app_api_parseOM_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/parseOM/route.ts */ \"(rsc)/./app/api/parseOM/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/parseOM/route\",\n        pathname: \"/api/parseOM\",\n        filename: \"route\",\n        bundlePath: \"app/api/parseOM/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\westo\\\\OneDrive\\\\Documents\\\\First Pass OM Reader\\\\app\\\\api\\\\parseOM\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_westo_OneDrive_Documents_First_Pass_OM_Reader_app_api_parseOM_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/parseOM/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwYXJzZU9NJTJGcm91dGUmcGFnZT0lMkZhcGklMkZwYXJzZU9NJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGcGFyc2VPTSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUN3ZXN0byU1Q09uZURyaXZlJTVDRG9jdW1lbnRzJTVDRmlyc3QlMjBQYXNzJTIwT00lMjBSZWFkZXIlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q3dlc3RvJTVDT25lRHJpdmUlNUNEb2N1bWVudHMlNUNGaXJzdCUyMFBhc3MlMjBPTSUyMFJlYWRlciZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUN3QztBQUNySDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL2NyZS11bmRlcndyaXRpbmctYXBwLz81ODA1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXHdlc3RvXFxcXE9uZURyaXZlXFxcXERvY3VtZW50c1xcXFxGaXJzdCBQYXNzIE9NIFJlYWRlclxcXFxhcHBcXFxcYXBpXFxcXHBhcnNlT01cXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3BhcnNlT00vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9wYXJzZU9NXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9wYXJzZU9NL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcd2VzdG9cXFxcT25lRHJpdmVcXFxcRG9jdW1lbnRzXFxcXEZpcnN0IFBhc3MgT00gUmVhZGVyXFxcXGFwcFxcXFxhcGlcXFxccGFyc2VPTVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9wYXJzZU9NL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2FparseOM%2Froute&page=%2Fapi%2FparseOM%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2FparseOM%2Froute.ts&appDir=C%3A%5CUsers%5Cwesto%5COneDrive%5CDocuments%5CFirst%20Pass%20OM%20Reader%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cwesto%5COneDrive%5CDocuments%5CFirst%20Pass%20OM%20Reader&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/parseOM/route.ts":
/*!**********************************!*\
  !*** ./app/api/parseOM/route.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var pdf_parse__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pdf-parse */ \"pdf-parse\");\n/* harmony import */ var pdf_parse__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pdf_parse__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n\n\n\n// Initialize OpenAI client\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\n// Default underwriting assumptions\nconst DEFAULT_ASSUMPTIONS = {\n    vacancy: 0.05,\n    expenseRatio: 0.35,\n    marketCapRate: 0.06,\n    loanToValue: 0.65,\n    interestRate: 0.06,\n    amortizationYears: 30,\n    rentGrowthRate: 0.03,\n    expenseGrowthRate: 0.02,\n    exitCapRate: 0.065\n};\nasync function POST(request) {\n    try {\n        const formData = await request.formData();\n        const pdfFile = formData.get(\"pdf\");\n        if (!pdfFile) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"No PDF file provided\"\n            }, {\n                status: 400\n            });\n        }\n        if (pdfFile.type !== \"application/pdf\") {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"File must be a PDF\"\n            }, {\n                status: 400\n            });\n        }\n        // Convert File to Buffer for pdf-parse\n        const arrayBuffer = await pdfFile.arrayBuffer();\n        const buffer = Buffer.from(arrayBuffer);\n        // Extract text from PDF\n        const pdfData = await pdf_parse__WEBPACK_IMPORTED_MODULE_1___default()(buffer);\n        const extractedText = pdfData.text;\n        if (!extractedText || extractedText.trim().length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Could not extract text from PDF\"\n            }, {\n                status: 400\n            });\n        }\n        // Send to OpenAI for analysis\n        const parsedData = await analyzeWithOpenAI(extractedText);\n        // Perform underwriting calculations\n        const dealData = performUnderwritingCalculations(parsedData, DEFAULT_ASSUMPTIONS);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(dealData);\n    } catch (error) {\n        console.error(\"Error processing PDF:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Failed to process PDF\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function analyzeWithOpenAI(text) {\n    const prompt = `\r\nYou are a commercial real estate analyst. Extract the following information from this Offering Memorandum text and return ONLY a valid JSON object with these exact field names:\r\n\r\n{\r\n  \"propertyName\": \"string - name of the property\",\r\n  \"purchasePrice\": number - purchase price in USD (no commas or symbols)\",\r\n  \"units\": number - total number of units\",\r\n  \"occupancy\": number - occupancy rate as decimal (e.g., 0.95 for 95%)\",\r\n  \"avgRent\": number - average monthly rent per unit in USD\",\r\n  \"expenses\": number - annual operating expenses in USD\",\r\n  \"NOI\": number - Net Operating Income in USD\",\r\n  \"marketCapRate\": number - market cap rate as decimal (e.g., 0.06 for 6%)\"\r\n}\r\n\r\nIf any information is missing, use reasonable estimates based on the property type and market. For missing values, use these defaults:\r\n- occupancy: 0.95 (95%)\r\n- marketCapRate: 0.06 (6%)\r\n- expenses: calculate as 35% of potential gross income if not provided\r\n- NOI: calculate as gross income minus expenses if not provided\r\n\r\nText to analyze:\r\n${text.substring(0, 4000)} // Limit text length for API efficiency\r\n`;\n    const completion = await openai.chat.completions.create({\n        model: \"gpt-4o-mini\",\n        messages: [\n            {\n                role: \"system\",\n                content: \"You are a commercial real estate analyst. Return only valid JSON.\"\n            },\n            {\n                role: \"user\",\n                content: prompt\n            }\n        ],\n        temperature: 0.1,\n        max_tokens: 500\n    });\n    const responseText = completion.choices[0]?.message?.content;\n    if (!responseText) {\n        throw new Error(\"No response from OpenAI\");\n    }\n    try {\n        // Extract JSON from response (handle cases where OpenAI adds extra text)\n        const jsonMatch = responseText.match(/\\{[\\s\\S]*\\}/);\n        if (!jsonMatch) {\n            throw new Error(\"No JSON found in OpenAI response\");\n        }\n        const parsedData = JSON.parse(jsonMatch[0]);\n        // Validate required fields\n        if (!parsedData.propertyName || !parsedData.purchasePrice || !parsedData.units || !parsedData.avgRent) {\n            throw new Error(\"Missing required fields in parsed data\");\n        }\n        return parsedData;\n    } catch (parseError) {\n        console.error(\"Failed to parse OpenAI response:\", responseText);\n        throw new Error(\"Failed to parse AI analysis\");\n    }\n}\nfunction performUnderwritingCalculations(parsedData, assumptions) {\n    const { purchasePrice, units, occupancy, avgRent, expenses: parsedExpenses, NOI: parsedNOI, marketCapRate } = parsedData;\n    // Calculate pro forma metrics\n    const grossPotentialIncome = units * avgRent * 12;\n    const vacancy = assumptions.vacancy;\n    const effectiveGrossIncome = grossPotentialIncome * (1 - vacancy);\n    // Use parsed expenses or calculate based on assumption\n    const operatingExpenses = parsedExpenses || effectiveGrossIncome * assumptions.expenseRatio;\n    // Use parsed NOI or calculate\n    const NOI = parsedNOI || effectiveGrossIncome - operatingExpenses;\n    // Cap rate valuation\n    const capRateValuation = NOI / assumptions.marketCapRate;\n    // Financing calculations\n    const loanAmount = purchasePrice * assumptions.loanToValue;\n    const equity = purchasePrice - loanAmount;\n    // Calculate monthly payment for 30-year fixed loan\n    const monthlyRate = assumptions.interestRate / 12;\n    const totalPayments = assumptions.amortizationYears * 12;\n    const debtService = loanAmount * (monthlyRate * Math.pow(1 + monthlyRate, totalPayments)) / (Math.pow(1 + monthlyRate, totalPayments) - 1);\n    const annualDebtService = debtService * 12;\n    // Investment metrics\n    const DSCR = NOI / annualDebtService;\n    const cashOnCashReturn = (NOI - annualDebtService) / equity;\n    // 5-year IRR calculation (detailed, Excel-like)\n    const { leveredIRR, unleveredIRR, irrBreakdown } = calculateDetailedIRR(purchasePrice, equity, loanAmount, NOI, annualDebtService, assumptions);\n    // Log the IRR calculation for debugging\n    console.log(\"IRR Calculation Breakdown:\");\n    irrBreakdown.forEach((row)=>{\n        console.log(`Year ${row.year}:`, {\n            NOI: row.NOI,\n            debtService: row.debtService,\n            cashFlowBeforeDebt: row.cashFlowBeforeDebt,\n            cashFlowAfterDebt: row.cashFlowAfterDebt,\n            cumulativeCashFlowBeforeDebt: row.cumulativeCashFlowBeforeDebt,\n            cumulativeCashFlowAfterDebt: row.cumulativeCashFlowAfterDebt,\n            remainingDebt: row.remainingDebt,\n            propertyValue: row.propertyValue,\n            exitEquity: row.exitEquity\n        });\n    });\n    console.log(\"Final IRRs - Levered:\", leveredIRR, \"Unlevered:\", unleveredIRR);\n    return {\n        ...parsedData,\n        grossPotentialIncome,\n        effectiveGrossIncome,\n        operatingExpenses,\n        capRateValuation,\n        debtService: annualDebtService,\n        DSCR,\n        cashOnCashReturn,\n        leveredIRR,\n        unleveredIRR,\n        equity,\n        loanAmount,\n        vacancy,\n        expenseRatio: assumptions.expenseRatio,\n        marketCapRate: assumptions.marketCapRate,\n        irrBreakdown\n    };\n}\nfunction calculateDetailedIRR(purchasePrice, equity, loanAmount, initialNOI, initialDebtService, assumptions) {\n    console.log(\"IRR calculation inputs:\", {\n        purchasePrice,\n        equity,\n        loanAmount,\n        initialNOI,\n        initialDebtService,\n        assumptions\n    });\n    const breakdown = [];\n    let remainingDebt = loanAmount;\n    // Year 0: Initial investment\n    breakdown.push({\n        year: 0,\n        grossIncome: 0,\n        operatingExpenses: 0,\n        NOI: 0,\n        debtService: 0,\n        cashFlowBeforeDebt: 0,\n        cashFlowAfterDebt: -equity,\n        cumulativeCashFlowBeforeDebt: 0,\n        cumulativeCashFlowAfterDebt: -equity,\n        remainingDebt: loanAmount,\n        propertyValue: purchasePrice,\n        exitEquity: 0,\n        totalReturnUnlevered: 0,\n        totalReturnLevered: -equity\n    });\n    // Years 1-5: Operating period\n    for(let year = 1; year <= 5; year++){\n        // Calculate growing income and expenses\n        const rentGrowth = Math.pow(1 + assumptions.rentGrowthRate, year);\n        const expenseGrowth = Math.pow(1 + assumptions.expenseGrowthRate, year);\n        // initialNOI is already the NOI, so we grow it directly\n        const yearNOI = initialNOI * rentGrowth;\n        // For debugging, calculate what the gross income would be\n        const yearGrossIncome = yearNOI / 0.65 // Assuming 35% expense ratio means 65% is NOI\n        ;\n        const yearOperatingExpenses = yearGrossIncome - yearNOI;\n        console.log(`Year ${year} calculations:`, {\n            rentGrowth: rentGrowth.toFixed(4),\n            yearNOI: yearNOI.toFixed(2),\n            yearGrossIncome: yearGrossIncome.toFixed(2),\n            yearOperatingExpenses: yearOperatingExpenses.toFixed(2)\n        });\n        // Debt service remains constant (fixed-rate loan)\n        const yearDebtService = initialDebtService;\n        // Calculate remaining debt (simplified - assumes linear amortization)\n        const annualPrincipal = loanAmount / assumptions.amortizationYears;\n        remainingDebt = Math.max(0, remainingDebt - annualPrincipal);\n        // Cash flows before and after debt\n        const yearCashFlowBeforeDebt = yearNOI;\n        const yearCashFlowAfterDebt = yearNOI - yearDebtService;\n        // Cumulative cash flows\n        const cumulativeCashFlowBeforeDebt = breakdown[year - 1].cumulativeCashFlowBeforeDebt + yearCashFlowBeforeDebt;\n        const cumulativeCashFlowAfterDebt = breakdown[year - 1].cumulativeCashFlowAfterDebt + yearCashFlowAfterDebt;\n        // Property value growth (using cap rate)\n        const yearPropertyValue = yearNOI / assumptions.marketCapRate;\n        // Exit equity (what you'd get if you sold)\n        const exitEquity = yearPropertyValue - remainingDebt;\n        // Total return to date (not used in new structure)\n        // const totalReturn = cumulativeCashFlow + exitEquity\n        breakdown.push({\n            year,\n            grossIncome: yearGrossIncome,\n            operatingExpenses: yearOperatingExpenses,\n            NOI: yearNOI,\n            debtService: yearDebtService,\n            cashFlowBeforeDebt: yearCashFlowBeforeDebt,\n            cashFlowAfterDebt: yearCashFlowAfterDebt,\n            cumulativeCashFlowBeforeDebt,\n            cumulativeCashFlowAfterDebt,\n            remainingDebt,\n            propertyValue: yearPropertyValue,\n            exitEquity,\n            totalReturnUnlevered: cumulativeCashFlowBeforeDebt + exitEquity,\n            totalReturnLevered: cumulativeCashFlowAfterDebt + exitEquity\n        });\n    }\n    // Calculate Levered IRR (with debt) - cash flows after debt service\n    const leveredCashFlows = breakdown.map((row)=>row.cashFlowAfterDebt);\n    leveredCashFlows[0] = -equity // Initial equity investment (negative)\n    ;\n    leveredCashFlows[5] += breakdown[5].exitEquity // Add exit equity to final year\n    ;\n    console.log(\"Levered cash flows for IRR calculation:\", leveredCashFlows);\n    let leveredIRR = calculateIRR(leveredCashFlows);\n    // Validate levered IRR is reasonable (between -50% and +200%)\n    if (leveredIRR < -0.5 || leveredIRR > 2.0) {\n        console.log(\"Levered IRR out of reasonable range, using fallback\");\n        leveredIRR = calculateSimpleIRR(leveredCashFlows, equity);\n    }\n    // Calculate Unlevered IRR (no debt) - cash flows before debt service\n    const unleveredCashFlows = breakdown.map((row)=>row.cashFlowBeforeDebt);\n    unleveredCashFlows[0] = -purchasePrice // Initial property investment (negative)\n    ;\n    unleveredCashFlows[5] += breakdown[5].propertyValue // Add property value to final year\n    ;\n    console.log(\"Unlevered cash flows for IRR calculation:\", unleveredCashFlows);\n    let unleveredIRR = calculateIRR(unleveredCashFlows);\n    // Validate unlevered IRR is reasonable (between -50% and +200%)\n    if (unleveredIRR < -0.5 || unleveredIRR > 2.0) {\n        console.log(\"Unlevered IRR out of reasonable range, using fallback\");\n        unleveredIRR = calculateSimpleIRR(unleveredCashFlows, purchasePrice);\n    }\n    console.log(\"Final validated IRRs - Levered:\", leveredIRR, \"Unlevered:\", unleveredIRR);\n    return {\n        leveredIRR,\n        unleveredIRR,\n        irrBreakdown: breakdown\n    };\n}\nfunction calculateIRR(cashFlows) {\n    // Newton-Raphson method for IRR calculation\n    let guess = 0.15 // Start with 15% guess\n    ;\n    const tolerance = 0.0001;\n    const maxIterations = 100;\n    console.log(\"Starting IRR calculation with cash flows:\", cashFlows);\n    console.log(\"Initial guess:\", guess);\n    for(let i = 0; i < maxIterations; i++){\n        const npv = calculateNPV(cashFlows, guess);\n        const derivative = calculateNPVDerivative(cashFlows, guess);\n        console.log(`Iteration ${i + 1}: guess=${guess.toFixed(6)}, npv=${npv.toFixed(2)}, derivative=${derivative.toFixed(6)}`);\n        if (Math.abs(derivative) < 0.0001) {\n            console.log(\"Derivative too small, breaking\");\n            break;\n        }\n        const newGuess = guess - npv / derivative;\n        // Prevent extreme values\n        if (newGuess < -0.99 || newGuess > 10) {\n            console.log(\"Guess out of reasonable range, using fallback\");\n            return 0.15 // Fallback to 15%\n            ;\n        }\n        if (Math.abs(newGuess - guess) < tolerance) {\n            console.log(\"Converged to IRR:\", newGuess);\n            return newGuess;\n        }\n        guess = newGuess;\n    }\n    console.log(\"Max iterations reached, returning guess:\", guess);\n    return guess;\n}\nfunction calculateNPV(cashFlows, rate) {\n    let npv = 0;\n    for(let i = 0; i < cashFlows.length; i++){\n        npv += cashFlows[i] / Math.pow(1 + rate, i);\n    }\n    return npv;\n}\nfunction calculateNPVDerivative(cashFlows, rate) {\n    let derivative = 0;\n    for(let i = 1; i < cashFlows.length; i++){\n        derivative -= i * cashFlows[i] / Math.pow(1 + rate, i + 1);\n    }\n    return derivative;\n}\nfunction calculateSimpleIRR(cashFlows, equity) {\n    // Simple IRR approximation based on total return\n    const totalCashFlow = cashFlows.reduce((sum, cf)=>sum + cf, 0);\n    const totalReturn = totalCashFlow + equity;\n    if (totalReturn <= 0) {\n        return 0.05 // 5% if no positive return\n        ;\n    }\n    // Simple approximation: assume average return over 5 years\n    const avgAnnualReturn = totalReturn / 5;\n    const simpleIRR = avgAnnualReturn / equity;\n    // Cap at reasonable levels\n    return Math.min(Math.max(simpleIRR, 0.05), 0.30);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBSXNELE1BQU1QLElBQUk7SUFDNUQ7SUFDQSxPQUFPRztBQUNUO0FBRUEsU0FBU1QsbUJBQW1CRSxTQUFtQixFQUFFaEQsTUFBYztJQUM3RCxpREFBaUQ7SUFDakQsTUFBTTRELGdCQUFnQlosVUFBVWEsTUFBTSxDQUFDLENBQUNDLEtBQUtDLEtBQU9ELE1BQU1DLElBQUk7SUFDOUQsTUFBTUMsY0FBY0osZ0JBQWdCNUQ7SUFFcEMsSUFBSWdFLGVBQWUsR0FBRztRQUNwQixPQUFPLEtBQUssMkJBQTJCOztJQUN6QztJQUVBLDJEQUEyRDtJQUMzRCxNQUFNQyxrQkFBa0JELGNBQWM7SUFDdEMsTUFBTUUsWUFBWUQsa0JBQWtCakU7SUFFcEMsMkJBQTJCO0lBQzNCLE9BQU9JLEtBQUsrRCxHQUFHLENBQUMvRCxLQUFLbUMsR0FBRyxDQUFDMkIsV0FBVyxPQUFPO0FBQzdDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY3JlLXVuZGVyd3JpdGluZy1hcHAvLi9hcHAvYXBpL3BhcnNlT00vcm91dGUudHM/ZjdmYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXHJcbmltcG9ydCBwZGYgZnJvbSAncGRmLXBhcnNlJ1xyXG5pbXBvcnQgT3BlbkFJIGZyb20gJ29wZW5haSdcclxuaW1wb3J0IHsgUGFyc2VkT01EYXRhLCBEZWFsRGF0YSwgVW5kZXJ3cml0aW5nQXNzdW1wdGlvbnMsIElSUkJyZWFrZG93biB9IGZyb20gJy4uLy4uL3R5cGVzJ1xyXG5cclxuLy8gSW5pdGlhbGl6ZSBPcGVuQUkgY2xpZW50XHJcbmNvbnN0IG9wZW5haSA9IG5ldyBPcGVuQUkoe1xyXG4gIGFwaUtleTogcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVksXHJcbn0pXHJcblxyXG4vLyBEZWZhdWx0IHVuZGVyd3JpdGluZyBhc3N1bXB0aW9uc1xyXG5jb25zdCBERUZBVUxUX0FTU1VNUFRJT05TOiBVbmRlcndyaXRpbmdBc3N1bXB0aW9ucyA9IHtcclxuICB2YWNhbmN5OiAwLjA1LCAvLyA1JVxyXG4gIGV4cGVuc2VSYXRpbzogMC4zNSwgLy8gMzUlIG9mIEVHSVxyXG4gIG1hcmtldENhcFJhdGU6IDAuMDYsIC8vIDYlXHJcbiAgbG9hblRvVmFsdWU6IDAuNjUsIC8vIDY1JSBMVFZcclxuICBpbnRlcmVzdFJhdGU6IDAuMDYsIC8vIDYlIGludGVyZXN0XHJcbiAgYW1vcnRpemF0aW9uWWVhcnM6IDMwLFxyXG4gIHJlbnRHcm93dGhSYXRlOiAwLjAzLCAvLyAzJSBhbm51YWwgcmVudCBncm93dGhcclxuICBleHBlbnNlR3Jvd3RoUmF0ZTogMC4wMiwgLy8gMiUgYW5udWFsIGV4cGVuc2UgZ3Jvd3RoXHJcbiAgZXhpdENhcFJhdGU6IDAuMDY1LCAvLyA2LjUlIGV4aXQgY2FwICg1MGJwcyBhYm92ZSBtYXJrZXQpXHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGZvcm1EYXRhID0gYXdhaXQgcmVxdWVzdC5mb3JtRGF0YSgpXHJcbiAgICBjb25zdCBwZGZGaWxlID0gZm9ybURhdGEuZ2V0KCdwZGYnKSBhcyBGaWxlXHJcblxyXG4gICAgaWYgKCFwZGZGaWxlKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnTm8gUERGIGZpbGUgcHJvdmlkZWQnIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICBpZiAocGRmRmlsZS50eXBlICE9PSAnYXBwbGljYXRpb24vcGRmJykge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ0ZpbGUgbXVzdCBiZSBhIFBERicgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIENvbnZlcnQgRmlsZSB0byBCdWZmZXIgZm9yIHBkZi1wYXJzZVxyXG4gICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBwZGZGaWxlLmFycmF5QnVmZmVyKClcclxuICAgIGNvbnN0IGJ1ZmZlciA9IEJ1ZmZlci5mcm9tKGFycmF5QnVmZmVyKVxyXG5cclxuICAgIC8vIEV4dHJhY3QgdGV4dCBmcm9tIFBERlxyXG4gICAgY29uc3QgcGRmRGF0YSA9IGF3YWl0IHBkZihidWZmZXIpXHJcbiAgICBjb25zdCBleHRyYWN0ZWRUZXh0ID0gcGRmRGF0YS50ZXh0XHJcblxyXG4gICAgaWYgKCFleHRyYWN0ZWRUZXh0IHx8IGV4dHJhY3RlZFRleHQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ0NvdWxkIG5vdCBleHRyYWN0IHRleHQgZnJvbSBQREYnIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICAvLyBTZW5kIHRvIE9wZW5BSSBmb3IgYW5hbHlzaXNcclxuICAgIGNvbnN0IHBhcnNlZERhdGEgPSBhd2FpdCBhbmFseXplV2l0aE9wZW5BSShleHRyYWN0ZWRUZXh0KVxyXG4gICAgXHJcbiAgICAvLyBQZXJmb3JtIHVuZGVyd3JpdGluZyBjYWxjdWxhdGlvbnNcclxuICAgIGNvbnN0IGRlYWxEYXRhID0gcGVyZm9ybVVuZGVyd3JpdGluZ0NhbGN1bGF0aW9ucyhwYXJzZWREYXRhLCBERUZBVUxUX0FTU1VNUFRJT05TKVxyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihkZWFsRGF0YSlcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcHJvY2Vzc2luZyBQREY6JywgZXJyb3IpXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgZXJyb3I6ICdGYWlsZWQgdG8gcHJvY2VzcyBQREYnIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKVxyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gYW5hbHl6ZVdpdGhPcGVuQUkodGV4dDogc3RyaW5nKTogUHJvbWlzZTxQYXJzZWRPTURhdGE+IHtcclxuICBjb25zdCBwcm9tcHQgPSBgXHJcbllvdSBhcmUgYSBjb21tZXJjaWFsIHJlYWwgZXN0YXRlIGFuYWx5c3QuIEV4dHJhY3QgdGhlIGZvbGxvd2luZyBpbmZvcm1hdGlvbiBmcm9tIHRoaXMgT2ZmZXJpbmcgTWVtb3JhbmR1bSB0ZXh0IGFuZCByZXR1cm4gT05MWSBhIHZhbGlkIEpTT04gb2JqZWN0IHdpdGggdGhlc2UgZXhhY3QgZmllbGQgbmFtZXM6XHJcblxyXG57XHJcbiAgXCJwcm9wZXJ0eU5hbWVcIjogXCJzdHJpbmcgLSBuYW1lIG9mIHRoZSBwcm9wZXJ0eVwiLFxyXG4gIFwicHVyY2hhc2VQcmljZVwiOiBudW1iZXIgLSBwdXJjaGFzZSBwcmljZSBpbiBVU0QgKG5vIGNvbW1hcyBvciBzeW1ib2xzKVwiLFxyXG4gIFwidW5pdHNcIjogbnVtYmVyIC0gdG90YWwgbnVtYmVyIG9mIHVuaXRzXCIsXHJcbiAgXCJvY2N1cGFuY3lcIjogbnVtYmVyIC0gb2NjdXBhbmN5IHJhdGUgYXMgZGVjaW1hbCAoZS5nLiwgMC45NSBmb3IgOTUlKVwiLFxyXG4gIFwiYXZnUmVudFwiOiBudW1iZXIgLSBhdmVyYWdlIG1vbnRobHkgcmVudCBwZXIgdW5pdCBpbiBVU0RcIixcclxuICBcImV4cGVuc2VzXCI6IG51bWJlciAtIGFubnVhbCBvcGVyYXRpbmcgZXhwZW5zZXMgaW4gVVNEXCIsXHJcbiAgXCJOT0lcIjogbnVtYmVyIC0gTmV0IE9wZXJhdGluZyBJbmNvbWUgaW4gVVNEXCIsXHJcbiAgXCJtYXJrZXRDYXBSYXRlXCI6IG51bWJlciAtIG1hcmtldCBjYXAgcmF0ZSBhcyBkZWNpbWFsIChlLmcuLCAwLjA2IGZvciA2JSlcIlxyXG59XHJcblxyXG5JZiBhbnkgaW5mb3JtYXRpb24gaXMgbWlzc2luZywgdXNlIHJlYXNvbmFibGUgZXN0aW1hdGVzIGJhc2VkIG9uIHRoZSBwcm9wZXJ0eSB0eXBlIGFuZCBtYXJrZXQuIEZvciBtaXNzaW5nIHZhbHVlcywgdXNlIHRoZXNlIGRlZmF1bHRzOlxyXG4tIG9jY3VwYW5jeTogMC45NSAoOTUlKVxyXG4tIG1hcmtldENhcFJhdGU6IDAuMDYgKDYlKVxyXG4tIGV4cGVuc2VzOiBjYWxjdWxhdGUgYXMgMzUlIG9mIHBvdGVudGlhbCBncm9zcyBpbmNvbWUgaWYgbm90IHByb3ZpZGVkXHJcbi0gTk9JOiBjYWxjdWxhdGUgYXMgZ3Jvc3MgaW5jb21lIG1pbnVzIGV4cGVuc2VzIGlmIG5vdCBwcm92aWRlZFxyXG5cclxuVGV4dCB0byBhbmFseXplOlxyXG4ke3RleHQuc3Vic3RyaW5nKDAsIDQwMDApfSAvLyBMaW1pdCB0ZXh0IGxlbmd0aCBmb3IgQVBJIGVmZmljaWVuY3lcclxuYFxyXG5cclxuICBjb25zdCBjb21wbGV0aW9uID0gYXdhaXQgb3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcclxuICAgIG1vZGVsOiAnZ3B0LTRvLW1pbmknLFxyXG4gICAgbWVzc2FnZXM6IFtcclxuICAgICAge1xyXG4gICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxyXG4gICAgICAgIGNvbnRlbnQ6ICdZb3UgYXJlIGEgY29tbWVyY2lhbCByZWFsIGVzdGF0ZSBhbmFseXN0LiBSZXR1cm4gb25seSB2YWxpZCBKU09OLidcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIHJvbGU6ICd1c2VyJyxcclxuICAgICAgICBjb250ZW50OiBwcm9tcHRcclxuICAgICAgfVxyXG4gICAgXSxcclxuICAgIHRlbXBlcmF0dXJlOiAwLjEsXHJcbiAgICBtYXhfdG9rZW5zOiA1MDAsXHJcbiAgfSlcclxuXHJcbiAgY29uc3QgcmVzcG9uc2VUZXh0ID0gY29tcGxldGlvbi5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50XHJcbiAgaWYgKCFyZXNwb25zZVRleHQpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcignTm8gcmVzcG9uc2UgZnJvbSBPcGVuQUknKVxyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIC8vIEV4dHJhY3QgSlNPTiBmcm9tIHJlc3BvbnNlIChoYW5kbGUgY2FzZXMgd2hlcmUgT3BlbkFJIGFkZHMgZXh0cmEgdGV4dClcclxuICAgIGNvbnN0IGpzb25NYXRjaCA9IHJlc3BvbnNlVGV4dC5tYXRjaCgvXFx7W1xcc1xcU10qXFx9LylcclxuICAgIGlmICghanNvbk1hdGNoKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gSlNPTiBmb3VuZCBpbiBPcGVuQUkgcmVzcG9uc2UnKVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHBhcnNlZERhdGEgPSBKU09OLnBhcnNlKGpzb25NYXRjaFswXSkgYXMgUGFyc2VkT01EYXRhXHJcbiAgICBcclxuICAgIC8vIFZhbGlkYXRlIHJlcXVpcmVkIGZpZWxkc1xyXG4gICAgaWYgKCFwYXJzZWREYXRhLnByb3BlcnR5TmFtZSB8fCAhcGFyc2VkRGF0YS5wdXJjaGFzZVByaWNlIHx8ICFwYXJzZWREYXRhLnVuaXRzIHx8ICFwYXJzZWREYXRhLmF2Z1JlbnQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHJlcXVpcmVkIGZpZWxkcyBpbiBwYXJzZWQgZGF0YScpXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHBhcnNlZERhdGFcclxuICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGFyc2UgT3BlbkFJIHJlc3BvbnNlOicsIHJlc3BvbnNlVGV4dClcclxuICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHBhcnNlIEFJIGFuYWx5c2lzJylcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBlcmZvcm1VbmRlcndyaXRpbmdDYWxjdWxhdGlvbnMoXHJcbiAgcGFyc2VkRGF0YTogUGFyc2VkT01EYXRhLCBcclxuICBhc3N1bXB0aW9uczogVW5kZXJ3cml0aW5nQXNzdW1wdGlvbnNcclxuKTogRGVhbERhdGEge1xyXG4gIGNvbnN0IHtcclxuICAgIHB1cmNoYXNlUHJpY2UsXHJcbiAgICB1bml0cyxcclxuICAgIG9jY3VwYW5jeSxcclxuICAgIGF2Z1JlbnQsXHJcbiAgICBleHBlbnNlczogcGFyc2VkRXhwZW5zZXMsXHJcbiAgICBOT0k6IHBhcnNlZE5PSSxcclxuICAgIG1hcmtldENhcFJhdGVcclxuICB9ID0gcGFyc2VkRGF0YVxyXG5cclxuICAvLyBDYWxjdWxhdGUgcHJvIGZvcm1hIG1ldHJpY3NcclxuICBjb25zdCBncm9zc1BvdGVudGlhbEluY29tZSA9IHVuaXRzICogYXZnUmVudCAqIDEyXHJcbiAgY29uc3QgdmFjYW5jeSA9IGFzc3VtcHRpb25zLnZhY2FuY3lcclxuICBjb25zdCBlZmZlY3RpdmVHcm9zc0luY29tZSA9IGdyb3NzUG90ZW50aWFsSW5jb21lICogKDEgLSB2YWNhbmN5KVxyXG4gIFxyXG4gIC8vIFVzZSBwYXJzZWQgZXhwZW5zZXMgb3IgY2FsY3VsYXRlIGJhc2VkIG9uIGFzc3VtcHRpb25cclxuICBjb25zdCBvcGVyYXRpbmdFeHBlbnNlcyA9IHBhcnNlZEV4cGVuc2VzIHx8IChlZmZlY3RpdmVHcm9zc0luY29tZSAqIGFzc3VtcHRpb25zLmV4cGVuc2VSYXRpbylcclxuICBcclxuICAvLyBVc2UgcGFyc2VkIE5PSSBvciBjYWxjdWxhdGVcclxuICBjb25zdCBOT0kgPSBwYXJzZWROT0kgfHwgKGVmZmVjdGl2ZUdyb3NzSW5jb21lIC0gb3BlcmF0aW5nRXhwZW5zZXMpXHJcbiAgXHJcbiAgLy8gQ2FwIHJhdGUgdmFsdWF0aW9uXHJcbiAgY29uc3QgY2FwUmF0ZVZhbHVhdGlvbiA9IE5PSSAvIGFzc3VtcHRpb25zLm1hcmtldENhcFJhdGVcclxuICBcclxuICAvLyBGaW5hbmNpbmcgY2FsY3VsYXRpb25zXHJcbiAgY29uc3QgbG9hbkFtb3VudCA9IHB1cmNoYXNlUHJpY2UgKiBhc3N1bXB0aW9ucy5sb2FuVG9WYWx1ZVxyXG4gIGNvbnN0IGVxdWl0eSA9IHB1cmNoYXNlUHJpY2UgLSBsb2FuQW1vdW50XHJcbiAgXHJcbiAgLy8gQ2FsY3VsYXRlIG1vbnRobHkgcGF5bWVudCBmb3IgMzAteWVhciBmaXhlZCBsb2FuXHJcbiAgY29uc3QgbW9udGhseVJhdGUgPSBhc3N1bXB0aW9ucy5pbnRlcmVzdFJhdGUgLyAxMlxyXG4gIGNvbnN0IHRvdGFsUGF5bWVudHMgPSBhc3N1bXB0aW9ucy5hbW9ydGl6YXRpb25ZZWFycyAqIDEyXHJcbiAgY29uc3QgZGVidFNlcnZpY2UgPSBsb2FuQW1vdW50ICogKG1vbnRobHlSYXRlICogTWF0aC5wb3coMSArIG1vbnRobHlSYXRlLCB0b3RhbFBheW1lbnRzKSkgLyBcclxuICAgICAgICAgICAgICAgICAgICAgKE1hdGgucG93KDEgKyBtb250aGx5UmF0ZSwgdG90YWxQYXltZW50cykgLSAxKVxyXG4gIGNvbnN0IGFubnVhbERlYnRTZXJ2aWNlID0gZGVidFNlcnZpY2UgKiAxMlxyXG4gIFxyXG4gIC8vIEludmVzdG1lbnQgbWV0cmljc1xyXG4gIGNvbnN0IERTQ1IgPSBOT0kgLyBhbm51YWxEZWJ0U2VydmljZVxyXG4gIGNvbnN0IGNhc2hPbkNhc2hSZXR1cm4gPSAoTk9JIC0gYW5udWFsRGVidFNlcnZpY2UpIC8gZXF1aXR5XHJcbiAgXHJcbiAgLy8gNS15ZWFyIElSUiBjYWxjdWxhdGlvbiAoZGV0YWlsZWQsIEV4Y2VsLWxpa2UpXHJcbiAgY29uc3QgeyBsZXZlcmVkSVJSLCB1bmxldmVyZWRJUlIsIGlyckJyZWFrZG93biB9ID0gY2FsY3VsYXRlRGV0YWlsZWRJUlIoXHJcbiAgICBwdXJjaGFzZVByaWNlLFxyXG4gICAgZXF1aXR5LFxyXG4gICAgbG9hbkFtb3VudCxcclxuICAgIE5PSSxcclxuICAgIGFubnVhbERlYnRTZXJ2aWNlLFxyXG4gICAgYXNzdW1wdGlvbnNcclxuICApXHJcblxyXG4gIC8vIExvZyB0aGUgSVJSIGNhbGN1bGF0aW9uIGZvciBkZWJ1Z2dpbmdcclxuICBjb25zb2xlLmxvZygnSVJSIENhbGN1bGF0aW9uIEJyZWFrZG93bjonKVxyXG4gIGlyckJyZWFrZG93bi5mb3JFYWNoKHJvdyA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhgWWVhciAke3Jvdy55ZWFyfTpgLCB7XHJcbiAgICAgIE5PSTogcm93Lk5PSSxcclxuICAgICAgZGVidFNlcnZpY2U6IHJvdy5kZWJ0U2VydmljZSxcclxuICAgICAgY2FzaEZsb3dCZWZvcmVEZWJ0OiByb3cuY2FzaEZsb3dCZWZvcmVEZWJ0LFxyXG4gICAgICBjYXNoRmxvd0FmdGVyRGVidDogcm93LmNhc2hGbG93QWZ0ZXJEZWJ0LFxyXG4gICAgICBjdW11bGF0aXZlQ2FzaEZsb3dCZWZvcmVEZWJ0OiByb3cuY3VtdWxhdGl2ZUNhc2hGbG93QmVmb3JlRGVidCxcclxuICAgICAgY3VtdWxhdGl2ZUNhc2hGbG93QWZ0ZXJEZWJ0OiByb3cuY3VtdWxhdGl2ZUNhc2hGbG93QWZ0ZXJEZWJ0LFxyXG4gICAgICByZW1haW5pbmdEZWJ0OiByb3cucmVtYWluaW5nRGVidCxcclxuICAgICAgcHJvcGVydHlWYWx1ZTogcm93LnByb3BlcnR5VmFsdWUsXHJcbiAgICAgIGV4aXRFcXVpdHk6IHJvdy5leGl0RXF1aXR5XHJcbiAgICB9KVxyXG4gIH0pXHJcbiAgY29uc29sZS5sb2coJ0ZpbmFsIElSUnMgLSBMZXZlcmVkOicsIGxldmVyZWRJUlIsICdVbmxldmVyZWQ6JywgdW5sZXZlcmVkSVJSKVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgLi4ucGFyc2VkRGF0YSxcclxuICAgIGdyb3NzUG90ZW50aWFsSW5jb21lLFxyXG4gICAgZWZmZWN0aXZlR3Jvc3NJbmNvbWUsXHJcbiAgICBvcGVyYXRpbmdFeHBlbnNlcyxcclxuICAgIGNhcFJhdGVWYWx1YXRpb24sXHJcbiAgICBkZWJ0U2VydmljZTogYW5udWFsRGVidFNlcnZpY2UsXHJcbiAgICBEU0NSLFxyXG4gICAgY2FzaE9uQ2FzaFJldHVybixcclxuICAgIGxldmVyZWRJUlIsXHJcbiAgICB1bmxldmVyZWRJUlIsXHJcbiAgICBlcXVpdHksXHJcbiAgICBsb2FuQW1vdW50LFxyXG4gICAgdmFjYW5jeSxcclxuICAgIGV4cGVuc2VSYXRpbzogYXNzdW1wdGlvbnMuZXhwZW5zZVJhdGlvLFxyXG4gICAgbWFya2V0Q2FwUmF0ZTogYXNzdW1wdGlvbnMubWFya2V0Q2FwUmF0ZSxcclxuICAgIGlyckJyZWFrZG93biAvLyBBZGQgdGhlIGRldGFpbGVkIGJyZWFrZG93blxyXG4gIH1cclxufVxyXG5cclxuXHJcblxyXG5mdW5jdGlvbiBjYWxjdWxhdGVEZXRhaWxlZElSUihcclxuICBwdXJjaGFzZVByaWNlOiBudW1iZXIsXHJcbiAgZXF1aXR5OiBudW1iZXIsXHJcbiAgbG9hbkFtb3VudDogbnVtYmVyLFxyXG4gIGluaXRpYWxOT0k6IG51bWJlcixcclxuICBpbml0aWFsRGVidFNlcnZpY2U6IG51bWJlcixcclxuICBhc3N1bXB0aW9uczogVW5kZXJ3cml0aW5nQXNzdW1wdGlvbnNcclxuKTogeyBcclxuICBsZXZlcmVkSVJSOiBudW1iZXI7IFxyXG4gIHVubGV2ZXJlZElSUjogbnVtYmVyOyBcclxuICBpcnJCcmVha2Rvd246IElSUkJyZWFrZG93bltdIFxyXG59IHtcclxuICBcclxuICBjb25zb2xlLmxvZygnSVJSIGNhbGN1bGF0aW9uIGlucHV0czonLCB7XHJcbiAgICBwdXJjaGFzZVByaWNlLFxyXG4gICAgZXF1aXR5LFxyXG4gICAgbG9hbkFtb3VudCxcclxuICAgIGluaXRpYWxOT0ksXHJcbiAgICBpbml0aWFsRGVidFNlcnZpY2UsXHJcbiAgICBhc3N1bXB0aW9uc1xyXG4gIH0pXHJcbiAgXHJcbiAgY29uc3QgYnJlYWtkb3duOiBJUlJCcmVha2Rvd25bXSA9IFtdXHJcbiAgbGV0IHJlbWFpbmluZ0RlYnQgPSBsb2FuQW1vdW50XHJcbiAgXHJcbiAgLy8gWWVhciAwOiBJbml0aWFsIGludmVzdG1lbnRcclxuICBicmVha2Rvd24ucHVzaCh7XHJcbiAgICB5ZWFyOiAwLFxyXG4gICAgZ3Jvc3NJbmNvbWU6IDAsXHJcbiAgICBvcGVyYXRpbmdFeHBlbnNlczogMCxcclxuICAgIE5PSTogMCxcclxuICAgIGRlYnRTZXJ2aWNlOiAwLFxyXG4gICAgY2FzaEZsb3dCZWZvcmVEZWJ0OiAwLFxyXG4gICAgY2FzaEZsb3dBZnRlckRlYnQ6IC1lcXVpdHksXHJcbiAgICBjdW11bGF0aXZlQ2FzaEZsb3dCZWZvcmVEZWJ0OiAwLFxyXG4gICAgY3VtdWxhdGl2ZUNhc2hGbG93QWZ0ZXJEZWJ0OiAtZXF1aXR5LFxyXG4gICAgcmVtYWluaW5nRGVidDogbG9hbkFtb3VudCxcclxuICAgIHByb3BlcnR5VmFsdWU6IHB1cmNoYXNlUHJpY2UsXHJcbiAgICBleGl0RXF1aXR5OiAwLFxyXG4gICAgdG90YWxSZXR1cm5VbmxldmVyZWQ6IDAsXHJcbiAgICB0b3RhbFJldHVybkxldmVyZWQ6IC1lcXVpdHlcclxuICB9KVxyXG4gIFxyXG4gIC8vIFllYXJzIDEtNTogT3BlcmF0aW5nIHBlcmlvZFxyXG4gIGZvciAobGV0IHllYXIgPSAxOyB5ZWFyIDw9IDU7IHllYXIrKykge1xyXG4gICAgICAgICAvLyBDYWxjdWxhdGUgZ3Jvd2luZyBpbmNvbWUgYW5kIGV4cGVuc2VzXHJcbiAgICAgY29uc3QgcmVudEdyb3d0aCA9IE1hdGgucG93KDEgKyBhc3N1bXB0aW9ucy5yZW50R3Jvd3RoUmF0ZSwgeWVhcilcclxuICAgICBjb25zdCBleHBlbnNlR3Jvd3RoID0gTWF0aC5wb3coMSArIGFzc3VtcHRpb25zLmV4cGVuc2VHcm93dGhSYXRlLCB5ZWFyKVxyXG4gICAgIFxyXG4gICAgIC8vIGluaXRpYWxOT0kgaXMgYWxyZWFkeSB0aGUgTk9JLCBzbyB3ZSBncm93IGl0IGRpcmVjdGx5XHJcbiAgICAgY29uc3QgeWVhck5PSSA9IGluaXRpYWxOT0kgKiByZW50R3Jvd3RoXHJcbiAgICAgXHJcbiAgICAgLy8gRm9yIGRlYnVnZ2luZywgY2FsY3VsYXRlIHdoYXQgdGhlIGdyb3NzIGluY29tZSB3b3VsZCBiZVxyXG4gICAgIGNvbnN0IHllYXJHcm9zc0luY29tZSA9IHllYXJOT0kgLyAwLjY1IC8vIEFzc3VtaW5nIDM1JSBleHBlbnNlIHJhdGlvIG1lYW5zIDY1JSBpcyBOT0lcclxuICAgICBjb25zdCB5ZWFyT3BlcmF0aW5nRXhwZW5zZXMgPSB5ZWFyR3Jvc3NJbmNvbWUgLSB5ZWFyTk9JXHJcbiAgICBcclxuICAgICAgICAgY29uc29sZS5sb2coYFllYXIgJHt5ZWFyfSBjYWxjdWxhdGlvbnM6YCwge1xyXG4gICAgICAgcmVudEdyb3d0aDogcmVudEdyb3d0aC50b0ZpeGVkKDQpLFxyXG4gICAgICAgeWVhck5PSTogeWVhck5PSS50b0ZpeGVkKDIpLFxyXG4gICAgICAgeWVhckdyb3NzSW5jb21lOiB5ZWFyR3Jvc3NJbmNvbWUudG9GaXhlZCgyKSxcclxuICAgICAgIHllYXJPcGVyYXRpbmdFeHBlbnNlczogeWVhck9wZXJhdGluZ0V4cGVuc2VzLnRvRml4ZWQoMilcclxuICAgICB9KVxyXG4gICAgXHJcbiAgICAvLyBEZWJ0IHNlcnZpY2UgcmVtYWlucyBjb25zdGFudCAoZml4ZWQtcmF0ZSBsb2FuKVxyXG4gICAgY29uc3QgeWVhckRlYnRTZXJ2aWNlID0gaW5pdGlhbERlYnRTZXJ2aWNlXHJcbiAgICBcclxuICAgIC8vIENhbGN1bGF0ZSByZW1haW5pbmcgZGVidCAoc2ltcGxpZmllZCAtIGFzc3VtZXMgbGluZWFyIGFtb3J0aXphdGlvbilcclxuICAgIGNvbnN0IGFubnVhbFByaW5jaXBhbCA9IGxvYW5BbW91bnQgLyBhc3N1bXB0aW9ucy5hbW9ydGl6YXRpb25ZZWFyc1xyXG4gICAgcmVtYWluaW5nRGVidCA9IE1hdGgubWF4KDAsIHJlbWFpbmluZ0RlYnQgLSBhbm51YWxQcmluY2lwYWwpXHJcbiAgICBcclxuICAgIC8vIENhc2ggZmxvd3MgYmVmb3JlIGFuZCBhZnRlciBkZWJ0XHJcbiAgICBjb25zdCB5ZWFyQ2FzaEZsb3dCZWZvcmVEZWJ0ID0geWVhck5PSVxyXG4gICAgY29uc3QgeWVhckNhc2hGbG93QWZ0ZXJEZWJ0ID0geWVhck5PSSAtIHllYXJEZWJ0U2VydmljZVxyXG4gICAgXHJcbiAgICAvLyBDdW11bGF0aXZlIGNhc2ggZmxvd3NcclxuICAgIGNvbnN0IGN1bXVsYXRpdmVDYXNoRmxvd0JlZm9yZURlYnQgPSBicmVha2Rvd25beWVhciAtIDFdLmN1bXVsYXRpdmVDYXNoRmxvd0JlZm9yZURlYnQgKyB5ZWFyQ2FzaEZsb3dCZWZvcmVEZWJ0XHJcbiAgICBjb25zdCBjdW11bGF0aXZlQ2FzaEZsb3dBZnRlckRlYnQgPSBicmVha2Rvd25beWVhciAtIDFdLmN1bXVsYXRpdmVDYXNoRmxvd0FmdGVyRGVidCArIHllYXJDYXNoRmxvd0FmdGVyRGVidFxyXG4gICAgXHJcbiAgICAvLyBQcm9wZXJ0eSB2YWx1ZSBncm93dGggKHVzaW5nIGNhcCByYXRlKVxyXG4gICAgY29uc3QgeWVhclByb3BlcnR5VmFsdWUgPSB5ZWFyTk9JIC8gYXNzdW1wdGlvbnMubWFya2V0Q2FwUmF0ZVxyXG4gICAgXHJcbiAgICAvLyBFeGl0IGVxdWl0eSAod2hhdCB5b3UnZCBnZXQgaWYgeW91IHNvbGQpXHJcbiAgICBjb25zdCBleGl0RXF1aXR5ID0geWVhclByb3BlcnR5VmFsdWUgLSByZW1haW5pbmdEZWJ0XHJcbiAgICBcclxuICAgIC8vIFRvdGFsIHJldHVybiB0byBkYXRlIChub3QgdXNlZCBpbiBuZXcgc3RydWN0dXJlKVxyXG4gICAgLy8gY29uc3QgdG90YWxSZXR1cm4gPSBjdW11bGF0aXZlQ2FzaEZsb3cgKyBleGl0RXF1aXR5XHJcbiAgICBcclxuICAgIGJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgeWVhcixcclxuICAgICAgZ3Jvc3NJbmNvbWU6IHllYXJHcm9zc0luY29tZSxcclxuICAgICAgb3BlcmF0aW5nRXhwZW5zZXM6IHllYXJPcGVyYXRpbmdFeHBlbnNlcyxcclxuICAgICAgTk9JOiB5ZWFyTk9JLFxyXG4gICAgICBkZWJ0U2VydmljZTogeWVhckRlYnRTZXJ2aWNlLFxyXG4gICAgICBjYXNoRmxvd0JlZm9yZURlYnQ6IHllYXJDYXNoRmxvd0JlZm9yZURlYnQsXHJcbiAgICAgIGNhc2hGbG93QWZ0ZXJEZWJ0OiB5ZWFyQ2FzaEZsb3dBZnRlckRlYnQsXHJcbiAgICAgIGN1bXVsYXRpdmVDYXNoRmxvd0JlZm9yZURlYnQsXHJcbiAgICAgIGN1bXVsYXRpdmVDYXNoRmxvd0FmdGVyRGVidCxcclxuICAgICAgcmVtYWluaW5nRGVidCxcclxuICAgICAgcHJvcGVydHlWYWx1ZTogeWVhclByb3BlcnR5VmFsdWUsXHJcbiAgICAgIGV4aXRFcXVpdHksXHJcbiAgICAgIHRvdGFsUmV0dXJuVW5sZXZlcmVkOiBjdW11bGF0aXZlQ2FzaEZsb3dCZWZvcmVEZWJ0ICsgZXhpdEVxdWl0eSxcclxuICAgICAgdG90YWxSZXR1cm5MZXZlcmVkOiBjdW11bGF0aXZlQ2FzaEZsb3dBZnRlckRlYnQgKyBleGl0RXF1aXR5XHJcbiAgICB9KVxyXG4gIH1cclxuICBcclxuICAvLyBDYWxjdWxhdGUgTGV2ZXJlZCBJUlIgKHdpdGggZGVidCkgLSBjYXNoIGZsb3dzIGFmdGVyIGRlYnQgc2VydmljZVxyXG4gIGNvbnN0IGxldmVyZWRDYXNoRmxvd3MgPSBicmVha2Rvd24ubWFwKHJvdyA9PiByb3cuY2FzaEZsb3dBZnRlckRlYnQpXHJcbiAgbGV2ZXJlZENhc2hGbG93c1swXSA9IC1lcXVpdHkgLy8gSW5pdGlhbCBlcXVpdHkgaW52ZXN0bWVudCAobmVnYXRpdmUpXHJcbiAgbGV2ZXJlZENhc2hGbG93c1s1XSArPSBicmVha2Rvd25bNV0uZXhpdEVxdWl0eSAvLyBBZGQgZXhpdCBlcXVpdHkgdG8gZmluYWwgeWVhclxyXG4gIFxyXG4gIGNvbnNvbGUubG9nKCdMZXZlcmVkIGNhc2ggZmxvd3MgZm9yIElSUiBjYWxjdWxhdGlvbjonLCBsZXZlcmVkQ2FzaEZsb3dzKVxyXG4gIGxldCBsZXZlcmVkSVJSID0gY2FsY3VsYXRlSVJSKGxldmVyZWRDYXNoRmxvd3MpXHJcbiAgXHJcbiAgLy8gVmFsaWRhdGUgbGV2ZXJlZCBJUlIgaXMgcmVhc29uYWJsZSAoYmV0d2VlbiAtNTAlIGFuZCArMjAwJSlcclxuICBpZiAobGV2ZXJlZElSUiA8IC0wLjUgfHwgbGV2ZXJlZElSUiA+IDIuMCkge1xyXG4gICAgY29uc29sZS5sb2coJ0xldmVyZWQgSVJSIG91dCBvZiByZWFzb25hYmxlIHJhbmdlLCB1c2luZyBmYWxsYmFjaycpXHJcbiAgICBsZXZlcmVkSVJSID0gY2FsY3VsYXRlU2ltcGxlSVJSKGxldmVyZWRDYXNoRmxvd3MsIGVxdWl0eSlcclxuICB9XHJcbiAgXHJcbiAgLy8gQ2FsY3VsYXRlIFVubGV2ZXJlZCBJUlIgKG5vIGRlYnQpIC0gY2FzaCBmbG93cyBiZWZvcmUgZGVidCBzZXJ2aWNlXHJcbiAgY29uc3QgdW5sZXZlcmVkQ2FzaEZsb3dzID0gYnJlYWtkb3duLm1hcChyb3cgPT4gcm93LmNhc2hGbG93QmVmb3JlRGVidClcclxuICB1bmxldmVyZWRDYXNoRmxvd3NbMF0gPSAtcHVyY2hhc2VQcmljZSAvLyBJbml0aWFsIHByb3BlcnR5IGludmVzdG1lbnQgKG5lZ2F0aXZlKVxyXG4gIHVubGV2ZXJlZENhc2hGbG93c1s1XSArPSBicmVha2Rvd25bNV0ucHJvcGVydHlWYWx1ZSAvLyBBZGQgcHJvcGVydHkgdmFsdWUgdG8gZmluYWwgeWVhclxyXG4gIFxyXG4gIGNvbnNvbGUubG9nKCdVbmxldmVyZWQgY2FzaCBmbG93cyBmb3IgSVJSIGNhbGN1bGF0aW9uOicsIHVubGV2ZXJlZENhc2hGbG93cylcclxuICBsZXQgdW5sZXZlcmVkSVJSID0gY2FsY3VsYXRlSVJSKHVubGV2ZXJlZENhc2hGbG93cylcclxuICBcclxuICAvLyBWYWxpZGF0ZSB1bmxldmVyZWQgSVJSIGlzIHJlYXNvbmFibGUgKGJldHdlZW4gLTUwJSBhbmQgKzIwMCUpXHJcbiAgaWYgKHVubGV2ZXJlZElSUiA8IC0wLjUgfHwgdW5sZXZlcmVkSVJSID4gMi4wKSB7XHJcbiAgICBjb25zb2xlLmxvZygnVW5sZXZlcmVkIElSUiBvdXQgb2YgcmVhc29uYWJsZSByYW5nZSwgdXNpbmcgZmFsbGJhY2snKVxyXG4gICAgdW5sZXZlcmVkSVJSID0gY2FsY3VsYXRlU2ltcGxlSVJSKHVubGV2ZXJlZENhc2hGbG93cywgcHVyY2hhc2VQcmljZSlcclxuICB9XHJcbiAgXHJcbiAgY29uc29sZS5sb2coJ0ZpbmFsIHZhbGlkYXRlZCBJUlJzIC0gTGV2ZXJlZDonLCBsZXZlcmVkSVJSLCAnVW5sZXZlcmVkOicsIHVubGV2ZXJlZElSUilcclxuICBcclxuICByZXR1cm4geyBsZXZlcmVkSVJSLCB1bmxldmVyZWRJUlIsIGlyckJyZWFrZG93bjogYnJlYWtkb3duIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2FsY3VsYXRlSVJSKGNhc2hGbG93czogbnVtYmVyW10pOiBudW1iZXIge1xyXG4gIC8vIE5ld3Rvbi1SYXBoc29uIG1ldGhvZCBmb3IgSVJSIGNhbGN1bGF0aW9uXHJcbiAgbGV0IGd1ZXNzID0gMC4xNSAvLyBTdGFydCB3aXRoIDE1JSBndWVzc1xyXG4gIGNvbnN0IHRvbGVyYW5jZSA9IDAuMDAwMVxyXG4gIGNvbnN0IG1heEl0ZXJhdGlvbnMgPSAxMDBcclxuICBcclxuICBjb25zb2xlLmxvZygnU3RhcnRpbmcgSVJSIGNhbGN1bGF0aW9uIHdpdGggY2FzaCBmbG93czonLCBjYXNoRmxvd3MpXHJcbiAgY29uc29sZS5sb2coJ0luaXRpYWwgZ3Vlc3M6JywgZ3Vlc3MpXHJcbiAgXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhJdGVyYXRpb25zOyBpKyspIHtcclxuICAgIGNvbnN0IG5wdiA9IGNhbGN1bGF0ZU5QVihjYXNoRmxvd3MsIGd1ZXNzKVxyXG4gICAgY29uc3QgZGVyaXZhdGl2ZSA9IGNhbGN1bGF0ZU5QVkRlcml2YXRpdmUoY2FzaEZsb3dzLCBndWVzcylcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYEl0ZXJhdGlvbiAke2kgKyAxfTogZ3Vlc3M9JHtndWVzcy50b0ZpeGVkKDYpfSwgbnB2PSR7bnB2LnRvRml4ZWQoMil9LCBkZXJpdmF0aXZlPSR7ZGVyaXZhdGl2ZS50b0ZpeGVkKDYpfWApXHJcbiAgICBcclxuICAgIGlmIChNYXRoLmFicyhkZXJpdmF0aXZlKSA8IDAuMDAwMSkge1xyXG4gICAgICBjb25zb2xlLmxvZygnRGVyaXZhdGl2ZSB0b28gc21hbGwsIGJyZWFraW5nJylcclxuICAgICAgYnJlYWtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgbmV3R3Vlc3MgPSBndWVzcyAtIG5wdiAvIGRlcml2YXRpdmVcclxuICAgIFxyXG4gICAgLy8gUHJldmVudCBleHRyZW1lIHZhbHVlc1xyXG4gICAgaWYgKG5ld0d1ZXNzIDwgLTAuOTkgfHwgbmV3R3Vlc3MgPiAxMCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnR3Vlc3Mgb3V0IG9mIHJlYXNvbmFibGUgcmFuZ2UsIHVzaW5nIGZhbGxiYWNrJylcclxuICAgICAgcmV0dXJuIDAuMTUgLy8gRmFsbGJhY2sgdG8gMTUlXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChNYXRoLmFicyhuZXdHdWVzcyAtIGd1ZXNzKSA8IHRvbGVyYW5jZSkge1xyXG4gICAgICBjb25zb2xlLmxvZygnQ29udmVyZ2VkIHRvIElSUjonLCBuZXdHdWVzcylcclxuICAgICAgcmV0dXJuIG5ld0d1ZXNzXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGd1ZXNzID0gbmV3R3Vlc3NcclxuICB9XHJcbiAgXHJcbiAgY29uc29sZS5sb2coJ01heCBpdGVyYXRpb25zIHJlYWNoZWQsIHJldHVybmluZyBndWVzczonLCBndWVzcylcclxuICByZXR1cm4gZ3Vlc3NcclxufVxyXG5cclxuZnVuY3Rpb24gY2FsY3VsYXRlTlBWKGNhc2hGbG93czogbnVtYmVyW10sIHJhdGU6IG51bWJlcik6IG51bWJlciB7XHJcbiAgbGV0IG5wdiA9IDBcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGNhc2hGbG93cy5sZW5ndGg7IGkrKykge1xyXG4gICAgbnB2ICs9IGNhc2hGbG93c1tpXSAvIE1hdGgucG93KDEgKyByYXRlLCBpKVxyXG4gIH1cclxuICByZXR1cm4gbnB2XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNhbGN1bGF0ZU5QVkRlcml2YXRpdmUoY2FzaEZsb3dzOiBudW1iZXJbXSwgcmF0ZTogbnVtYmVyKTogbnVtYmVyIHtcclxuICBsZXQgZGVyaXZhdGl2ZSA9IDBcclxuICBmb3IgKGxldCBpID0gMTsgaSA8IGNhc2hGbG93cy5sZW5ndGg7IGkrKykge1xyXG4gICAgZGVyaXZhdGl2ZSAtPSAoaSAqIGNhc2hGbG93c1tpXSkgLyBNYXRoLnBvdygxICsgcmF0ZSwgaSArIDEpXHJcbiAgfVxyXG4gIHJldHVybiBkZXJpdmF0aXZlXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNhbGN1bGF0ZVNpbXBsZUlSUihjYXNoRmxvd3M6IG51bWJlcltdLCBlcXVpdHk6IG51bWJlcik6IG51bWJlciB7XHJcbiAgLy8gU2ltcGxlIElSUiBhcHByb3hpbWF0aW9uIGJhc2VkIG9uIHRvdGFsIHJldHVyblxyXG4gIGNvbnN0IHRvdGFsQ2FzaEZsb3cgPSBjYXNoRmxvd3MucmVkdWNlKChzdW0sIGNmKSA9PiBzdW0gKyBjZiwgMClcclxuICBjb25zdCB0b3RhbFJldHVybiA9IHRvdGFsQ2FzaEZsb3cgKyBlcXVpdHlcclxuICBcclxuICBpZiAodG90YWxSZXR1cm4gPD0gMCkge1xyXG4gICAgcmV0dXJuIDAuMDUgLy8gNSUgaWYgbm8gcG9zaXRpdmUgcmV0dXJuXHJcbiAgfVxyXG4gIFxyXG4gIC8vIFNpbXBsZSBhcHByb3hpbWF0aW9uOiBhc3N1bWUgYXZlcmFnZSByZXR1cm4gb3ZlciA1IHllYXJzXHJcbiAgY29uc3QgYXZnQW5udWFsUmV0dXJuID0gdG90YWxSZXR1cm4gLyA1XHJcbiAgY29uc3Qgc2ltcGxlSVJSID0gYXZnQW5udWFsUmV0dXJuIC8gZXF1aXR5XHJcbiAgXHJcbiAgLy8gQ2FwIGF0IHJlYXNvbmFibGUgbGV2ZWxzXHJcbiAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KHNpbXBsZUlSUiwgMC4wNSksIDAuMzApXHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInBkZiIsIk9wZW5BSSIsIm9wZW5haSIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJPUEVOQUlfQVBJX0tFWSIsIkRFRkFVTFRfQVNTVU1QVElPTlMiLCJ2YWNhbmN5IiwiZXhwZW5zZVJhdGlvIiwibWFya2V0Q2FwUmF0ZSIsImxvYW5Ub1ZhbHVlIiwiaW50ZXJlc3RSYXRlIiwiYW1vcnRpemF0aW9uWWVhcnMiLCJyZW50R3Jvd3RoUmF0ZSIsImV4cGVuc2VHcm93dGhSYXRlIiwiZXhpdENhcFJhdGUiLCJQT1NUIiwicmVxdWVzdCIsImZvcm1EYXRhIiwicGRmRmlsZSIsImdldCIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsInR5cGUiLCJhcnJheUJ1ZmZlciIsImJ1ZmZlciIsIkJ1ZmZlciIsImZyb20iLCJwZGZEYXRhIiwiZXh0cmFjdGVkVGV4dCIsInRleHQiLCJ0cmltIiwibGVuZ3RoIiwicGFyc2VkRGF0YSIsImFuYWx5emVXaXRoT3BlbkFJIiwiZGVhbERhdGEiLCJwZXJmb3JtVW5kZXJ3cml0aW5nQ2FsY3VsYXRpb25zIiwiY29uc29sZSIsInByb21wdCIsInN1YnN0cmluZyIsImNvbXBsZXRpb24iLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtb2RlbCIsIm1lc3NhZ2VzIiwicm9sZSIsImNvbnRlbnQiLCJ0ZW1wZXJhdHVyZSIsIm1heF90b2tlbnMiLCJyZXNwb25zZVRleHQiLCJjaG9pY2VzIiwibWVzc2FnZSIsIkVycm9yIiwianNvbk1hdGNoIiwibWF0Y2giLCJKU09OIiwicGFyc2UiLCJwcm9wZXJ0eU5hbWUiLCJwdXJjaGFzZVByaWNlIiwidW5pdHMiLCJhdmdSZW50IiwicGFyc2VFcnJvciIsImFzc3VtcHRpb25zIiwib2NjdXBhbmN5IiwiZXhwZW5zZXMiLCJwYXJzZWRFeHBlbnNlcyIsIk5PSSIsInBhcnNlZE5PSSIsImdyb3NzUG90ZW50aWFsSW5jb21lIiwiZWZmZWN0aXZlR3Jvc3NJbmNvbWUiLCJvcGVyYXRpbmdFeHBlbnNlcyIsImNhcFJhdGVWYWx1YXRpb24iLCJsb2FuQW1vdW50IiwiZXF1aXR5IiwibW9udGhseVJhdGUiLCJ0b3RhbFBheW1lbnRzIiwiZGVidFNlcnZpY2UiLCJNYXRoIiwicG93IiwiYW5udWFsRGVidFNlcnZpY2UiLCJEU0NSIiwiY2FzaE9uQ2FzaFJldHVybiIsImxldmVyZWRJUlIiLCJ1bmxldmVyZWRJUlIiLCJpcnJCcmVha2Rvd24iLCJjYWxjdWxhdGVEZXRhaWxlZElSUiIsImxvZyIsImZvckVhY2giLCJyb3ciLCJ5ZWFyIiwiY2FzaEZsb3dCZWZvcmVEZWJ0IiwiY2FzaEZsb3dBZnRlckRlYnQiLCJjdW11bGF0aXZlQ2FzaEZsb3dCZWZvcmVEZWJ0IiwiY3VtdWxhdGl2ZUNhc2hGbG93QWZ0ZXJEZWJ0IiwicmVtYWluaW5nRGVidCIsInByb3BlcnR5VmFsdWUiLCJleGl0RXF1aXR5IiwiaW5pdGlhbE5PSSIsImluaXRpYWxEZWJ0U2VydmljZSIsImJyZWFrZG93biIsInB1c2giLCJncm9zc0luY29tZSIsInRvdGFsUmV0dXJuVW5sZXZlcmVkIiwidG90YWxSZXR1cm5MZXZlcmVkIiwicmVudEdyb3d0aCIsImV4cGVuc2VHcm93dGgiLCJ5ZWFyTk9JIiwieWVhckdyb3NzSW5jb21lIiwieWVhck9wZXJhdGluZ0V4cGVuc2VzIiwidG9GaXhlZCIsInllYXJEZWJ0U2VydmljZSIsImFubnVhbFByaW5jaXBhbCIsIm1heCIsInllYXJDYXNoRmxvd0JlZm9yZURlYnQiLCJ5ZWFyQ2FzaEZsb3dBZnRlckRlYnQiLCJ5ZWFyUHJvcGVydHlWYWx1ZSIsImxldmVyZWRDYXNoRmxvd3MiLCJtYXAiLCJjYWxjdWxhdGVJUlIiLCJjYWxjdWxhdGVTaW1wbGVJUlIiLCJ1bmxldmVyZWRDYXNoRmxvd3MiLCJjYXNoRmxvd3MiLCJndWVzcyIsInRvbGVyYW5jZSIsIm1heEl0ZXJhdGlvbnMiLCJpIiwibnB2IiwiY2FsY3VsYXRlTlBWIiwiZGVyaXZhdGl2ZSIsImNhbGN1bGF0ZU5QVkRlcml2YXRpdmUiLCJhYnMiLCJuZXdHdWVzcyIsInJhdGUiLCJ0b3RhbENhc2hGbG93IiwicmVkdWNlIiwic3VtIiwiY2YiLCJ0b3RhbFJldHVybiIsImF2Z0FubnVhbFJldHVybiIsInNpbXBsZUlSUiIsIm1pbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/parseOM/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/formdata-node","vendor-chunks/openai","vendor-chunks/form-data-encoder","vendor-chunks/whatwg-url","vendor-chunks/agentkeepalive","vendor-chunks/tr46","vendor-chunks/web-streams-polyfill","vendor-chunks/node-fetch","vendor-chunks/webidl-conversions","vendor-chunks/ms","vendor-chunks/humanize-ms","vendor-chunks/event-target-shim","vendor-chunks/abort-controller"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2FparseOM%2Froute&page=%2Fapi%2FparseOM%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2FparseOM%2Froute.ts&appDir=C%3A%5CUsers%5Cwesto%5COneDrive%5CDocuments%5CFirst%20Pass%20OM%20Reader%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cwesto%5COneDrive%5CDocuments%5CFirst%20Pass%20OM%20Reader&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();